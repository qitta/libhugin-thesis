

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4 Implementierung &mdash; Projektarbeit</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'../../',
        VERSION:'0.1',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
    <link rel="top" title="Projektarbeit" href="../../index.html"/>
        <link rel="next" title="5 Test" href="../V/index.html"/>
        <link rel="prev" title="3 Design" href="../III/index.html"/>

<link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
<link rel="stylesheet" type="text/css" href="../../_static/colorbox/colorbox.css" />

<script type="text/javascript" src="../../_static/colorbox/jquery.colorbox-min.js" />
<script type="text/javascript">
	function endsWith(str, suffix) {
	    return str.indexOf(suffix, str.length - suffix.length) !== -1;
	}

    $(document).ready(function() {
    	var im, imsrc;
    	$('img').each(function() {
    		im = $(this);
    		imsrc = im.attr('src');
    		imalt = im.attr('alt');
    		if (endsWith(imsrc, 'svg')) {
    			im.wrap($('<a>').attr({'href': imsrc, 'title': imalt}).addClass('svglink'));
    		}
    	});

    	$('a.svglink').colorbox({
    		'width': '95%',
    		'height': '95%',
    		'photo': true});
    });
</script>


  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="icon icon-home"> Projektarbeit</a>
        <form class="wy-form" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../abstract.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Danksagung</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dedication.html">Widmung</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../I/index.html">1 Einleitung</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../I/index.html#motivation">1.1 Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../I/index.html#namensgebung">1.2 Namensgebung</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../II/index.html">2 Einstieg</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#einsatzszenarien">2.1 Einsatzszenarien</a></li>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#vorhandene-alternativen">2.2 Vorhandene Alternativen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#vorhandene-arbeiten">2.3 Vorhandene Arbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#schlussfolgerungen">2.4 Schlussfolgerungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#anforderungen">2.5 Anforderungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#zielgruppe">2.6 Zielgruppe</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../III/index.html">3 Design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../III/index.html#architektur">3.1 Architektur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../III/index.html#algorithmik">3.2 Algorithmik</a></li>
<li class="toctree-l2"><a class="reference internal" href="../III/index.html#integration-von-libmunin-in-die-umwelt">3.3 Integration von libmunin in die Umwelt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../III/index.html#periphere-komponenten">3.4 Periphere Komponenten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../III/index.html#entwurf-der-software">3.5 Entwurf der Software</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">4 Implementierung</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#entwicklungsumgebung">4.1 Entwicklungsumgebung</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kurze-implementierungshistorie">4.2 Kurze Implementierungshistorie</a></li>
<li class="toctree-l2"><a class="reference internal" href="#liste-verfugbarer-provider-und-distanzfunktionen">4.3 Liste verfügbarer Provider und Distanzfunktionen</a></li>
<li class="toctree-l2"><a class="reference internal" href="#paketubersicht">4.4 Paketübersicht</a></li>
<li class="toctree-l2"><a class="reference internal" href="#anwendungsbeispiel">4.5 Anwendungsbeispiel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#statistiken">4.6 Statistiken</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../V/index.html">5 Test</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../V/index.html#erfullung-der-anforderungen">5.1 Erfüllung der Anforderungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../V/index.html#verifizierung">5.2 Verifizierung</a></li>
<li class="toctree-l2"><a class="reference internal" href="../V/index.html#validierung">5.3 Validierung</a></li>
<li class="toctree-l2"><a class="reference internal" href="../V/index.html#demonanwendung-als-debugger">5.4 Demonanwendung als Debugger</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../VI/index.html">6 Zusammenfassung</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../VI/index.html#ausblick">6.1 Ausblick</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VI/index.html#mogliche-weiterentwicklungen">6.2 Mögliche Weiterentwicklungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VI/index.html#fazit">6.3 Fazit</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html">Abkürzungsverzeichnis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html#glossar">Glossar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html#online-ressourcen">Online Ressourcen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">Projektarbeit</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <ul class="wy-breadcrumbs">
  <li><a href="../index.html">Docs</a> &raquo;</li>
  <li><a href="">4 Implementierung</a></li>
  
</ul>
<hr/>

          
  <div class="section" id="implementierung">
<h1>4 Implementierung<a class="headerlink" href="#implementierung" title="Permalink to this headline">¶</a></h1>
<blockquote class="epigraph">
<div><p>'' <em>Programmieren Sie immer so, als wäre der Typ, der den Code pflegen muss, ein
gewaltbereiter Psychopath, der weiß, wo Sie wohnen.</em> ''</p>
<p class="attribution">&mdash;<em>Peter Stöhr</em></p>
</div></blockquote>
<div class="section" id="entwicklungsumgebung">
<h2>4.1 Entwicklungsumgebung<a class="headerlink" href="#entwicklungsumgebung" title="Permalink to this headline">¶</a></h2>
<p>Als Programmiersprache wurde <em>Python</em> aus folgenden Gründen ausgewählt:</p>
<ul class="simple">
<li>Exzellenter Support für <em>Rapid Prototyping</em> - eine wichtige Eigenschaft bei
nur knapp 3 Monaten Implementierungs-Zeit.</li>
<li>Große Zahl an nützlichen Libraries, besonders für den wissenschaftlichen Einsatz.</li>
<li>Neben <em>C</em> die <em>Lingua Franca</em> des Autors.</li>
</ul>
<p>Alle Quellen die während dieses Projektes entstanden sind finden sich auf der
sozialen Code-Hosting Plattform Github. Der Vorteil dieser Plattform besteht
darin dass sie von sehr vielen Entwicklern besucht werden, die die Software
ausprobieren und möglicherweise verbessern oder zumindestens die Seite für
spätere Projekte bookmarken.  Daher auch Github's Slogan <em>Social Coding</em>.</p>
<p>Die dazugehörige Dokumentation wird bei jedem commit automatisch aus den
Sourcen, mittels des freien Dokumentationsgenerators Sphinx, auf der
Dokumentations-Hosting Plattform <em>ReadTheDocs</em> gebaut und dort verfügbar
gemacht: <a class="reference external" href="https://libmunin.rtfd.org">https://libmunin.rtfd.org</a></p>
<p>Zudem werden pro Commit unittests auf der Continious-Integration Plattform
<em>TravisCI</em> für verschiedene Python-Versionen durchgeführt.  Dies hat den Vorteil
dass fehlerhafte Versionen aufgedeckt werden, selbst wenn man vergessen hat die
unittests lokal durchzuführen.</p>
<p>Schlägt der Build fehl so färben sich kleine Buttons in den oben genannten
Diensten rot und man wird per Mail benachrichtigt. (Siehe <a href="#fig-travis-badge">4.1</a>)</p>
<div class="figure align-center" id="fig-travis-badge">
<img alt="Screenshot der Statusbuttons auf der Github-Seite." src="../../_images/travis_badge.png" />
<p class="caption"><strong>Figure 4.1:</strong> Screenshot der Statusbuttons auf der Github-Seite.</p>
</div>
<p>Versionen die als stabil eingestuft werden, werden auf <em>PyPi (Python Package Index)</em>
veröffentlicht, wo sie mithilfe des folgenden Befehles samt
Python-Abhängigkeiten installiert werden können:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo pip install libmunin
</pre></div>
</div>
<p>Auf lokaler Seite wird jede Änderungen versioniert, um die Fehlersuche zu
vereinfachen - im Notfall kann man stets auf funktionierende Versionen
zurückgehen.</p>
<p>Der Quelltext selber wird in <em>gVim</em> geschrieben. Dass sich der Python-Quelltext
dabei an die gängigen Konventionen hält wird durch die Zusatzprogramme <em>PEP8</em>
und <em>flake8</em> überprüft.</p>
</div>
<div class="section" id="kurze-implementierungshistorie">
<h2>4.2 Kurze Implementierungshistorie<a class="headerlink" href="#kurze-implementierungshistorie" title="Permalink to this headline">¶</a></h2>
<p>Probleme:</p>
<blockquote>
<div><ul class="simple">
<li>Graphenaufbau (combinations = teuer)</li>
<li>Festlegung von distance_add funktionsweise</li>
</ul>
</div></blockquote>
<p><a class="reference external" href="http://libmunin.readthedocs.org/en/latest/logbuch.html">http://libmunin.readthedocs.org/en/latest/logbuch.html</a></p>
</div>
<div class="section" id="liste-verfugbarer-provider-und-distanzfunktionen">
<h2>4.3 Liste verfügbarer Provider und Distanzfunktionen<a class="headerlink" href="#liste-verfugbarer-provider-und-distanzfunktionen" title="Permalink to this headline">¶</a></h2>
<p>Insgesamt wurden 13 unterschiedliche Provider implementiert - davon variieren
einige allerdings nur in Details. Dazu gesellen sich 9 Distanzfunktionen - auch
manche davon unterscheiden sich nur in ihrer Fusionierungsmethode.</p>
<div class="section" id="liste-der-distanzfunktionen">
<h3>4.3.1 Liste der Distanzfunktionen<a class="headerlink" href="#liste-der-distanzfunktionen" title="Permalink to this headline">¶</a></h3>
<p>Die genaue Berechnung der Distanz wird in der Bachelorarbeit betrachtet.</p>
<div class="section" id="date">
<h4>4.3.1.1 <tt class="docutils literal"><span class="pre">Date</span></tt><a class="headerlink" href="#date" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="moodbar">
<h4>4.3.1.2 <tt class="docutils literal"><span class="pre">Moodbar</span></tt><a class="headerlink" href="#moodbar" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="rating">
<h4>4.3.1.3 <tt class="docutils literal"><span class="pre">Rating</span></tt><a class="headerlink" href="#rating" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="bpm">
<h4>4.3.1.4 <tt class="docutils literal"><span class="pre">BPM</span></tt><a class="headerlink" href="#bpm" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="wordlist-levenshtein-keywords">
<h4>4.3.1.5 <tt class="docutils literal"><span class="pre">Wordlist</span></tt>, <tt class="docutils literal"><span class="pre">Levenshtein</span></tt>, <tt class="docutils literal"><span class="pre">Keywords</span></tt><a class="headerlink" href="#wordlist-levenshtein-keywords" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="genretreeavglink-genretree">
<h4>4.3.1.6 <tt class="docutils literal"><span class="pre">GenreTreeAvgLink</span></tt>, <tt class="docutils literal"><span class="pre">GenreTree</span></tt><a class="headerlink" href="#genretreeavglink-genretree" title="Permalink to this headline">¶</a></h4>
</div>
</div>
<div class="section" id="id1">
<h3>4.3.2 Liste der Distanzfunktionen<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Die genaue Funtkionsweise der Provider wird in der Bachelorarbeitet betrachtet.
Im folgenden wird nur eine Auflistung verfügbarer Provider gegeben und welche
Eingabe sie erwarten sowie welche Ausgabe sie produzieren.</p>
<div class="section" id="id2">
<h4>4.3.2.1 <tt class="docutils literal"><span class="pre">Date</span></tt><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Wandelt und normalisiert ein Datum dass als String übergeben wird zu einer
Jahreszahl (<em>1975</em> beispielsweise). Dabei werden die häufigsten
Datum-Formattierungen automatisch erkannt. Dies ist nötig da je nach Region ganz
unterschiedliche Datumsangaben in den Audiofiles getaggt sind.</p>
</div>
<div class="section" id="id3">
<h4>4.3.2.2 <tt class="docutils literal"><span class="pre">Moodbar</span></tt><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Berechnet mit dem <tt class="docutils literal"><span class="pre">moodbar</span></tt> (TODO: zitieren) Programm aus einen beliebigen
Audio File einen Vektor mit 1000 RGB-Farbwerten. Jeder dieser Farbwerte
repräsentiert den Anteil niedriger Frequenzen (rot), mittlerer (grün) und
hoher Frequenzen (blau) in einem Tausendstel des Audiostücks.</p>
<p>Obwohl man aus dem Namen dises Verfahren schließen könnte dass hier die
<em>Stimmung</em> im Lied angedeutet wird, kann man aus diesen Informationen
lediglich herauslesen wie ,,engergetisch'' ein Lied zu einem bestimmten
Zeitpunkt ist - mit etwas Glück kann man auch Instrumente erkennen - so ist
die Kombination von E-Gitarre und Drums oft ein helles Türkis.</p>
<p>Aus diesem RGB-Vektoren werden die prägnantesten Merkmale abgeleitet - die
dominaten Farben, der Stilleanteil (<em>schwarz</em>) und einige weitere Merkmale.</p>
<p>Dieser Provider kommt in drei verschiedenen Ausführungen daher die sich in dem
Typ ihrer Eingabe unterscheiden:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">Moodbar</span></tt>: Nimmt eine Liste von 1000 RGB-Werten.</li>
<li><tt class="docutils literal"><span class="pre">MoodbarFile</span></tt>: Nimmt ein Pfad zu einem von der <tt class="docutils literal"><span class="pre">moodbar</span></tt> erstellten Datei
entgegen die einen Vektor aus 1000 RGB-Werten binär beeinhaltet.</li>
<li><tt class="docutils literal"><span class="pre">MoodbarAudioFile</span></tt>: Nimmt ein Pfad zu einer beliebigen Audio-Datei entgegen
und führt das <tt class="docutils literal"><span class="pre">moodbar</span></tt>-Utility darauf aus falls noch keine weiter Datei mit
demselben Pfad plus der zusätzlichen Endung <tt class="docutils literal"><span class="pre">.mood</span></tt> vorhanden ist.</li>
</ul>
</div>
<div class="section" id="wordlist">
<h4>4.3.2.3 <tt class="docutils literal"><span class="pre">Wordlist</span></tt><a class="headerlink" href="#wordlist" title="Permalink to this headline">¶</a></h4>
<p>Bricht einen String in eine Liste von Wörter auf.</p>
</div>
<div class="section" id="id4">
<h4>4.3.2.4 <tt class="docutils literal"><span class="pre">BPM</span></tt><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Berechnet die ,,Beats-Per-Minute'' eines Lieds (Zitieren) - dies funktioniert
nicht nur für stark beat-lastige Musikrichtungen wie Techno sondern auch für
normale Musikrichtungen.</p>
<p>TODO: Hinweis auf bpm-tools</p>
</div>
<div class="section" id="normalize-artistnormalize-albumnormalize">
<h4>4.3.2.5 <tt class="docutils literal"><span class="pre">Normalize</span></tt>, <tt class="docutils literal"><span class="pre">ArtistNormalize</span></tt>, <tt class="docutils literal"><span class="pre">AlbumNormalize</span></tt><a class="headerlink" href="#normalize-artistnormalize-albumnormalize" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="composite">
<h4>4.3.2.6 <tt class="docutils literal"><span class="pre">Composite</span></tt><a class="headerlink" href="#composite" title="Permalink to this headline">¶</a></h4>
<p>Erlaubt das Verketten von Providern. Er erste Eingabewert wird dem ersten
Provider in der Kette gegeben und die Ausgabe, ähnliche wie beiner Unix-Pipe,
wird an den nächsten Provider in der Kette als Eingabe weitergegeben.</p>
<p>Ein Anwendungsbeispiel wäre das Zusammenschalten</p>
<div class="highlight-python"><pre>Eingabe: Artist, Album -&gt; PlyrLyrics | Stem | Keywords -&gt; Ausgabe: Stemmed Keywords</pre>
</div>
</div>
<div class="section" id="stem">
<h4>4.3.2.7 <tt class="docutils literal"><span class="pre">Stem</span></tt><a class="headerlink" href="#stem" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="genretree">
<h4>4.3.2.8 <tt class="docutils literal"><span class="pre">GenreTree</span></tt><a class="headerlink" href="#genretree" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="keywords">
<h4>4.3.2.9 <tt class="docutils literal"><span class="pre">Keywords</span></tt><a class="headerlink" href="#keywords" title="Permalink to this headline">¶</a></h4>
<p>Extrahiert aus einem Text als Eingabe alle <em>relevanten</em> Stichwörter.
Ein Beispiel dieser <em>Keywords</em> wird in <a href="#fig-yellow-keywords">4.2</a> gezeigt.
Zudem wird die Sprache des Eingabetextes erkannt und mit abgespeichert.</p>
<div class="figure align-center" id="fig-yellow-keywords">
<center><table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head align-right">Rating</th>
<th class="head align-left">Keywords</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="align-right">22.558</td>
<td class="align-left">'yellow', 'submarin'</td>
</tr>
<tr class="row-odd"><td class="align-right">20.835</td>
<td class="align-left">'full', 'speed', 'ahead', 'mr'</td>
</tr>
<tr class="row-even"><td class="align-right">8.343</td>
<td class="align-left">'live', 'beneath'</td>
</tr>
<tr class="row-odd"><td class="align-right">5.247</td>
<td class="align-left">'band', 'begin'</td>
</tr>
<tr class="row-even"><td class="align-right">3.297</td>
<td class="align-left">'sea'</td>
</tr>
<tr class="row-odd"><td class="align-right">3.227</td>
<td class="align-left">'green'</td>
</tr>
<tr class="row-even"><td class="align-right">2.797</td>
<td class="align-left">'captain'
...</td>
</tr>
</tbody>
</table>
<p class="caption"><strong>Figure 4.2:</strong> Anzahl der Arbeiten auf Google Scholar zum Suchbegriff
,,Music Recommendation'' aufgeteilt auf die Jahre 1994-2014.</p>
</center></div></div>
<div class="section" id="plyrlyrics">
<h4>4.3.2.10 <tt class="docutils literal"><span class="pre">PlyrLyrics</span></tt><a class="headerlink" href="#plyrlyrics" title="Permalink to this headline">¶</a></h4>
<p>Besorgt mittels <em>libglyr</em> Liedtexte aus dem Internet. Bereits gesuchte Liedtexte
werden dabei zwischengespeichert. Dieser <a class="reference internal" href="../appendix.html#term-provider"><em class="xref std std-term">Provider</em></a> eignet sich besonders im
Zusammenhang mit dem <em>Keywords</em> zusammen als <em>Composite</em> Provider.</p>
</div>
<div class="section" id="discogsgenre">
<h4>4.3.2.11 <tt class="docutils literal"><span class="pre">DiscogsGenre</span></tt><a class="headerlink" href="#discogsgenre" title="Permalink to this headline">¶</a></h4>
</div>
</div>
</div>
<div class="section" id="paketubersicht">
<h2>4.4 Paketübersicht<a class="headerlink" href="#paketubersicht" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>tree munin/
munin/
|---- __init__.py                     | Versionierungs Info
|---- __main__.py                     | Beispielprogramm
|---- database.py                     | Manager für alle vorhandenen Songs
|---- dbus_service.py                 | <span class="o">[</span>Unfertiger<span class="o">]</span> Dbus Service für libmunin
|---- dbus_client.py                  | <span class="o">[</span>Unfertiger<span class="o">]</span> DBus Client
|---- distance/                       | Unterverzeichnis für Distanzfunktionen
|   |---- __init__.py                 | Oberklasse für jede Distanzfunktion
|   |---- bpm.py                      | BeatsPerMinute Distanzfunktion
|   |---- date.py                     | ...
|   |---- ...                         |
|---- session.py                      | Implementierung der Session <span class="o">(</span>API<span class="o">)</span>
|---- easy.py                         | Vereinfachte Session-API
|---- graph.py                        | Implementiert Graphenoperationen
|---- helper.py                       | Verschiedene Utilityfunktionen
|---- history.py                      | Implementierung beider Histories
|                                     | und Assoziationsregeln
|---- plot.py                         | Visualisierungsfunktionen
|---- provider/                       | Unterverzeichnis für alle Provider
|   |---- __init__.py                 | Oberklasse für jeden Provider
|   |---- bpm.py                      | BeatsPerMinute Provider
|   |---- composite.py                | ...
|   |---- ...                         |
|---- rake.py                         | Implementierung des RAKE Algorithmus
|---- scripts/                        | Verschiedene eigenständige Helper
|   |---- moodbar_visualizer.py       | Visualisiert ein moodbar-output
|   |---- moodbar_walk.py             | Berechnet die moodbar parallel für
|                                     | jedes Audiofile in einem Verzeichnis
|---- song.py                         | Implementierung der Song Klasse
|---- stopwords/                      |
|   |---- __init__.py                 | Stoppwort Implementierung
|   |---- data                        | Stoppwort Datenbank
|   |   |---- de                      | Jede Datei beeinhaltet pro Zeile
|   |   |---- en                      | eine Stoppowrt der jeweiligen Sprache
|   |   |---- es                      | ISO 638-1 Language Code.
|   |   |---- ...                     |
|---- testing.py                      | Fixtures und Helper für unittests
</pre></div>
</div>
</div>
<div class="section" id="anwendungsbeispiel">
<h2>4.5 Anwendungsbeispiel<a class="headerlink" href="#anwendungsbeispiel" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span class="hll"><span class="kn">from</span> <span class="nn">munin.easy</span> <span class="kn">import</span> <span class="n">EasySession</span>
</span>
<span class="hll"><span class="n">MY_DATABASE</span> <span class="o">=</span> <span class="p">[</span>
</span>    <span class="c"># Artist:            Album:               Title:             Genre:</span>
    <span class="p">(</span><span class="s">&#39;Akrea&#39;</span>          <span class="p">,</span> <span class="s">&#39;Lebenslinie&#39;</span>      <span class="p">,</span> <span class="s">&#39;Trugbild&#39;</span>       <span class="p">,</span> <span class="s">&#39;death metal&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;Vogelfrey&#39;</span>      <span class="p">,</span> <span class="s">&#39;Wiegenfest&#39;</span>       <span class="p">,</span> <span class="s">&#39;Heldentod&#39;</span>      <span class="p">,</span> <span class="s">&#39;folk metal&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;Letzte Instanz&#39;</span> <span class="p">,</span> <span class="s">&#39;Götter auf Abruf&#39;</span> <span class="p">,</span> <span class="s">&#39;Salve te&#39;</span>       <span class="p">,</span> <span class="s">&#39;folk rock&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s">&#39;Debauchery&#39;</span>     <span class="p">,</span> <span class="s">&#39;Continue to Kill&#39;</span> <span class="p">,</span> <span class="s">&#39;Apostle of War&#39;</span> <span class="p">,</span> <span class="s">&#39;brutal death&#39;</span><span class="p">)</span>
<span class="p">]</span>

<span class="hll"><span class="n">session</span> <span class="o">=</span> <span class="n">EasySession</span><span class="p">()</span>
</span><span class="hll"><span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
</span>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">album</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">genre</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">MY_DATABASE</span><span class="p">):</span>
<span class="hll">         <span class="n">session</span><span class="o">.</span><span class="n">mapping</span><span class="p">[</span><span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">({</span>
</span>             <span class="s">&#39;artist&#39;</span><span class="p">:</span> <span class="n">artist</span><span class="p">,</span>
             <span class="s">&#39;album&#39;</span><span class="p">:</span> <span class="n">album</span><span class="p">,</span>
             <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
             <span class="s">&#39;genre&#39;</span><span class="p">:</span> <span class="n">genre</span>
         <span class="p">})]</span> <span class="o">=</span> <span class="n">idx</span>

<span class="hll"><span class="k">for</span> <span class="n">munin_song</span> <span class="ow">in</span> <span class="n">session</span><span class="o">.</span><span class="n">recommend_from_seed</span><span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">):</span>
</span>    <span class="k">print</span><span class="p">(</span><span class="n">MY_DATABASE</span><span class="p">[</span><span class="n">munin_song</span><span class="o">.</span><span class="n">uid</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>Ist <em>libmunin</em> korrekt installiert, so lässt sich dieses Skript als
<tt class="docutils literal"><span class="pre">minimal.py</span></tt> ablegen und folgendermaßen ausführen:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python minimal.py
<span class="o">(</span><span class="s1">&#39;Vogelfrey&#39;</span>  , <span class="s1">&#39;Wiegenfest&#39;</span>       , <span class="s1">&#39;Heldentod&#39;</span>      , <span class="s1">&#39;folk metal&#39;</span><span class="o">)</span>,
<span class="o">(</span><span class="s1">&#39;Debauchery&#39;</span> , <span class="s1">&#39;Continue to Kill&#39;</span> , <span class="s1">&#39;Apostle of War&#39;</span> , <span class="s1">&#39;brutal death&#39;</span><span class="o">)</span>
</pre></div>
</div>
<div class="section" id="kurze-erlauterung-des-beispiels">
<h3>4.5.1 Kurze Erläuterung des Beispiels<a class="headerlink" href="#kurze-erlauterung-des-beispiels" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><strong>Zeile 1:</strong></p>
<p>Der Einstiegspunkt von <em>libmunin's</em> API ist immer eine <em>Session</em>.
Da die Konfiguration einer solchen (Auswahl von Provider, Distanzfunktionen
und Weighting) mitunder recht anstrengend werden kann greifen wir auf eine
Session mit vorgefertigter <a class="reference internal" href="../appendix.html#term-maske"><em class="xref std std-term">Maske</em></a> zurück - die sogenannte
<tt class="docutils literal"><span class="pre">EasySession</span></tt>.</p>
</li>
<li><p class="first"><strong>Zeile 3:</strong></p>
<p>Hier erstellen wir uns eine Pseudo-Datenbank aus vier Liedern mit vier
einzelnen Attributen jeweils.</p>
</li>
<li><p class="first"><strong>Zeile 11:</strong></p>
<p>Hier wird die oben erwähnte <tt class="docutils literal"><span class="pre">EasySession</span></tt> instanziert. Sie dient uns jetzt
als <em>Sitzung</em> - alle relevanten Methoden von <em>libmunin</em> können auf der
<em>Session</em> aufgerufen werden.</p>
</li>
<li><p class="first"><strong>Zeile 12:</strong></p>
<p>Bein initialen Importieren der Datenbank werden alle Songs über die <tt class="docutils literal"><span class="pre">add</span></tt>
Operation hinzugefügt. Da <tt class="docutils literal"><span class="pre">add</span></tt> noch keine Verbindungen zwischen den
einzelnen Songs herstellt stellen wir mit dieser Zeile sicher nach dem
Importieren ein <tt class="docutils literal"><span class="pre">rebuild</span></tt> ausgeführt wird.</p>
</li>
<li><p class="first"><strong>Zeile 14:</strong></p>
<p>Wir iterieren (<strong>Zeile 13</strong>) über alle Songs in unserer Pseudo-Datenbank und
fügen diese der <em>Session</em> hinzu (über die <tt class="docutils literal"><span class="pre">add</span></tt> Operation). zu beachten ist
dabei: Es wird eine Hashtable übergeben in denen bestimmte Schlüssel (wie
<tt class="docutils literal"><span class="pre">artist</span></tt>) von der <tt class="docutils literal"><span class="pre">EasySession</span></tt> vorgegeben sind - erstellt man eine eigene
Session kann man diese nach Belieben Konfigurieren.</p>
<p>Ein Problem dass man bei der Benutzung der Library hat ist: <em>libmunin</em> und der
Nutzter halten zwei verschiedene Datenbanken im Speicher. Der Benutzer
verwaltet die Originaldaten mit denen er arbeitet während <em>libmunin</em> nur
normalisierte Daten speichert. Das Problem dabei: Wie soll der User wissen
welche Empfehlung zu welchen Song in seinen Originaldaten gehört?</p>
<p>Dazu ist ein Mapping erforderlich das
Zu diesem Zwecke geben die Operationen <tt class="docutils literal"><span class="pre">add</span></tt>, <tt class="docutils literal"><span class="pre">insert</span></tt>, <tt class="docutils literal"><span class="pre">modify</span></tt> und
<tt class="docutils literal"><span class="pre">remove</span></tt> eine eindeutige ID zurück die einen von <em>libmunin's</em> Songs
referenziert. Der Benutzer kann diese nutzen um auf eine ID innerhalb <em>seiner</em>
Datenbank zu referenzieren.</p>
<p>Im obigen Beispiel wird die von <tt class="docutils literal"><span class="pre">add</span></tt> zurückgebene ID auf die ID innerhalb
von <em>MY_DATABASE</em> gemappt.</p>
</li>
<li><p class="first"><strong>Zeile 21:</strong></p>
<p>In dieser Zeile geben wir die ersten Empfehlung aus. Wir lassen uns von der
<tt class="docutils literal"><span class="pre">EasySession</span></tt> über die Methode <tt class="docutils literal"><span class="pre">recommend_from_seed</span></tt> zwei Empfehlungen zum ersten
Song der über <tt class="docutils literal"><span class="pre">add</span></tt> hinzugefügt wurde geben. Die Empfehlung selbst wird als
<tt class="docutils literal"><span class="pre">Song</span></tt> Objekt ausgebene - dieses hat unter anderen eine ID gespeichert mit
der wir die ursprünglichen Daten finden können.</p>
</li>
</ul>
<p>Dieses und weitere Beispiele finden sich auf der API-Dokumentation im Web:</p>
<blockquote>
<div><a class="reference external" href="http://libmunin.rtfd.org">http://libmunin.rtfd.org</a></div></blockquote>
</div>
<div class="section" id="kurze-erlauterung-des-outputs">
<h3>4.5.2 Kurze Erläuterung des Outputs<a class="headerlink" href="#kurze-erlauterung-des-outputs" title="Permalink to this headline">¶</a></h3>
<p>Der Output ist nicht weiter überraschend: Da sich nur das Genre effektiv
vergleichen lässt und wir uns von dem ersten Song (,, <em>Trugbild</em> '') zwei
Empfehlungen geben ließen werden die zwei Songs mit dem ähnlichsten Genre
ausgegeben.</p>
<p>[TODO: Den Mini-Graph einfügen]</p>
</div>
</div>
<div class="section" id="statistiken">
<h2>4.6 Statistiken<a class="headerlink" href="#statistiken" title="Permalink to this headline">¶</a></h2>
<p>LoC Statistiken:</p>
<div class="highlight-bash"><div class="highlight"><pre>      65 text files.
      63 unique files.
      19 files ignored.

http://cloc.sourceforge.net v 1.60  <span class="nv">T</span><span class="o">=</span>0.34 s <span class="o">(</span>135.8 files/s, 26868.3 lines/s<span class="o">)</span>
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
Python                          46           2063           2169           4867
-------------------------------------------------------------------------------
SUM:                            46           2063           2169           4867
-------------------------------------------------------------------------------
</pre></div>
</div>
<p>Dazu kommen einige weitere Zeilen von <em>reStructuredText</em> die die Basis der
Onlinedokumentation bilden:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>wc -l <span class="k">$(</span>find . -iname <span class="s1">&#39;*.rst&#39;</span><span class="k">)</span>
2231 insgesamt
</pre></div>
</div>
<p>Zudem lassen sich einige Statistiken präsentieren die automatisch aus den
<tt class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></tt> entstanden sind:</p>
<blockquote>
<div><ul>
<li><p class="first">GitHub Visualisierungen:</p>
<blockquote>
<div><p><a class="reference external" href="https://github.com/sahib/libmunin/graphs">https://github.com/sahib/libmunin/graphs</a></p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">gitstats</span></tt> Visualisierungen:</p>
<blockquote>
<div><p><a class="reference external" href="http://sahib.github.io/libmunin-thesis/gitstats/index.html">http://sahib.github.io/libmunin-thesis/gitstats/index.html</a></p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">gource</span></tt> Commit-Graph Visualisierung:</p>
<blockquote>
<div><p>... TODO ...</p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
</div>


          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="../V/index.html" class="btn btn-neutral float-right" title="5 Test"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../III/index.html" class="btn btn-neutral" title="3 Design"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <p>
      &copy; Copyright by Christopher Pahl, 2013-2014..
  </p>

  <a href="https://www.github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="http://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  

</body>
</html>