

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3 Design &mdash; Projektarbeit</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'../../',
        VERSION:'0.1',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
    <link rel="top" title="Projektarbeit" href="../../index.html"/>
        <link rel="next" title="4 Implementierung" href="../IV/index.html"/>
        <link rel="prev" title="2 Einstieg" href="../II/index.html"/>

<link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
<link rel="stylesheet" type="text/css" href="../../_static/colorbox/colorbox.css" />

<script type="text/javascript" src="../../_static/colorbox/jquery.colorbox-min.js" />
<script type="text/javascript">
	function endsWith(str, suffix) {
	    return str.indexOf(suffix, str.length - suffix.length) !== -1;
	}

    $(document).ready(function() {
    	var im, imsrc;
    	$('img').each(function() {
    		im = $(this);
    		imsrc = im.attr('src');
    		imalt = im.attr('alt');
    		if (endsWith(imsrc, 'svg')) {
    			im.wrap($('<a>').attr({'href': imsrc, 'title': imalt}).addClass('svglink'));
    		}
    	});

    	$('a.svglink').colorbox({
    		'width': '95%',
    		'height': '95%',
    		'photo': true});
    });
</script>


  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="icon icon-home"> Projektarbeit</a>
        <form class="wy-form" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../abstract.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Danksagung</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dedication.html">Widmung</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../I/index.html">1 Einleitung</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../I/index.html#motivation">1.1 Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../I/index.html#namensgebung">1.2 Namensgebung</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../II/index.html">2 Einstieg</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#einsatzszenarien">2.1 Einsatzszenarien</a></li>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#vorhandene-alternativen">2.2 Vorhandene Alternativen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#vorhandene-arbeiten">2.3 Vorhandene Arbeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#schlussfolgerungen">2.4 Schlussfolgerungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#anforderungen">2.5 Anforderungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../II/index.html#zielgruppe">2.6 Zielgruppe</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">3 Design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#algorithmik">3.1 Algorithmik</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integration-von-libmunin-in-die-umwelt">3.2 Integration von <em>libmunin</em> in die Umwelt</a></li>
<li class="toctree-l2"><a class="reference internal" href="#entwurf-der-software">3.3 Entwurf der Software</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../IV/index.html">4 Implementierung</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../IV/index.html#anwendungsbeispiel">4.1 Anwendungsbeispiel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../IV/index.html#kurze-implementierungshistorie">4.2 Kurze Implementierungshistorie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../IV/index.html#liste-verfugbarer-empfehlungs-strategien">4.3 Liste verfügbarer Empfehlungs-Strategien</a></li>
<li class="toctree-l2"><a class="reference internal" href="../IV/index.html#liste-verfugbarer-provider-und-distanzfunktionen">4.4 Liste verfügbarer Provider und Distanzfunktionen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../IV/index.html#modul-und-paketubersicht">4.5 Modul- und Paketübersicht</a></li>
<li class="toctree-l2"><a class="reference internal" href="../IV/index.html#trivia">4.6 Trivia</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../V/index.html">5 Demonstrationsanwendung</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../V/index.html#intro">5.1 Intro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../V/index.html#anwendungsubersicht">5.2 Anwendungsübersicht</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../VI/index.html">6 Zusammenfassung</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../VI/index.html#was-wurde-erreicht">6.1 Was wurde erreicht?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VI/index.html#was-hatte-das-mit-data-mining-zu-tun">6.2 Was hatte das mit Data-Mining zu tun?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VI/index.html#welche-anforderungen-wurden-nicht-oder-unvollstandig-erfullt">6.3 Welche Anforderungen wurden nicht oder unvollständig erfüllt?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VI/index.html#implementierungsdefizite">6.4 Implementierungsdefizite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VI/index.html#denkbare-weiterentwicklungen">6.5 Denkbare Weiterentwicklungen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VI/index.html#abschlieszendes-fazit">6.6 Abschließendes Fazit</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html">Abkürzungsverzeichnis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html#glossar">Glossar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html#coldstart-py"><tt class="docutils literal"><span class="pre">coldstart.py</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html#ausfuhrliches-beispiel">Ausführliches Beispiel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendix.html#ausgabe-nach-dem-ersten-lauf">Ausgabe nach dem ersten Lauf:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix.html#ausgabe-nach-dem-10ten-lauf">Ausgabe nach dem 10ten Lauf:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../zzz_bibliography.html">Bibliographie</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzz_bibliography.html#weblink-verzeichnis">Weblink Verzeichnis</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">Projektarbeit</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <ul class="wy-breadcrumbs">
  <li><a href="../index.html">Docs</a> &raquo;</li>
  <li><a href="">3 Design</a></li>
  
</ul>
<hr/>

          
  <div class="section" id="design">
<h1>3 Design<a class="headerlink" href="#design" title="Permalink to this headline">¶</a></h1>
<blockquote class="epigraph">
<div><div class="line-block">
<div class="line"><em>,,If the implementation is hard to explain, it's a bad idea.</em></div>
<div class="line"><em>If the implementation is easy to explain, it</em> may <em>be a good idea.''</em></div>
</div>
<p class="attribution">&mdash;<em>Zen of Python</em>, <tt class="docutils literal"><span class="pre">import</span> <span class="pre">this</span></tt></p>
</div></blockquote>
<div class="section" id="algorithmik">
<h2>3.1 Algorithmik<a class="headerlink" href="#algorithmik" title="Permalink to this headline">¶</a></h2>
<p>Die genaue Beschreibung der Algorithmik wird in der Bachelorarbeit
detailliert besprochen. Hier nur ein kurzer Überblick, was mit welchem Ziel
implementiert wird.</p>
<p><em>Ein kurzer Leitfaden für dieses Kapitel:</em></p>
<ul class="simple">
<li>Es wird erst ein grober Überblick über die verwendeten <em>Datenstrukturen und der
Algorithmik</em> gegeben (dem <em>Kern</em> von <em>libmunin</em>)</li>
<li>Danach wird die <em>Umwelt</em> betrachtet und wie die Daten aussehen, die in unsere
Datenstrukturen eingepflegt werden müssen.</li>
<li>Im Anschluss daran wird überlegt wie die <em>Schnittstelle</em> aussehen muss, um die
Daten von der Außenseite zu importieren.</li>
<li>Letztlich wird ein möglicher <em>Softwareentwurf</em> vorgestellt und detailliert
besprochen.</li>
</ul>
<div class="section" id="grunduberlegungen">
<h3>3.1.1 Grundüberlegungen<a class="headerlink" href="#grunduberlegungen" title="Permalink to this headline">¶</a></h3>
<p>Die <em>Entfernung</em> von je einem <a class="reference internal" href="../appendix.html#term-song"><em class="xref std std-term">Song</em></a> <em>A</em> und <em>B</em> lässt sich durch eine
<a class="reference internal" href="../appendix.html#term-distanz"><em class="xref std std-term">Distanz</em></a> definieren.</p>
<p>Um die Distanzen zu speichern wird bei vielen Datamining-Projekten eine
Distanzmatrix genutzt - also eine quadratische Dreiecksmatrix in der
die Distanzen von jedem Dokument zu jedem anderen gespeichert werden.</p>
<p>Da das System auch für eine sehr hohe Anzahl von Songs funktionieren soll,
schließt sich die Benutzung einer Distanzmatrix allerdings von alleine aus.
Nehmen wir an ein Benutzer möchte seine Musiksammlung mit 40.000 Liedern
importieren, so bräuchten wir soviele Felder in der Matrix:</p>
<div class="math">
\[\frac{(40.000^2 - 40.0000)}{2} = 799.980.000\]</div>
<p>Nimmt man für jedes Feld einen günstig geschätzten Speicherverbrauch von 4 Byte
an, so bräuchte man allein für die Distanzmatrix hier aufgerundet 3 Gigabyte
Hauptspeicher - was selbst für diesen günstig geschätzten Fall unakzeptabel
wäre. Auch eine Sparsematrix wäre hier kaum sinnvoll, da in allen Fällen ja
etwas weniger als die Hälfte aller Felder befüllt ist.</p>
<p>Man muss also versuchen nur eine bestimmte Anzahl von Distanzen für einen Song
zu speichern - vorzugsweise eine Menge von Songs mit der kleinsten
<a class="reference internal" href="../appendix.html#term-distanz"><em class="xref std std-term">Distanz</em></a>. Als geeignete Datenstruktur erscheint hier ein Graph - die
Knoten desselben sind die Songs und die Kanten dazwischen die Distanzen.</p>
<p>Zur besseren optischen Vorstellung, ist unter <a href="#fig-graph-example">3.1</a> ein
Graphen-Plot gezeigt der diese Anforderungen erfüllt.</p>
<div class="figure align-center" id="fig-graph-example">
<a class="reference internal image-reference" href="../../_images/graph_example.png"><img alt="Beispielgraph aus generierten Testdaten" src="../../_images/graph_example.png" style="width: 85%;" /></a>
<p class="caption"><strong>Figure 3.1:</strong> Beispielgraph mit 100 Knoten, aus generierten Testdaten. Die Farbe der
Knoten zeigt grob die ,,Zentralität'' des Knoten an. Pro Knoten wurde ein
Integer zwischen 1-100 errechnet, diese wurden mit einer primitiven
Distanzfunktion verglichen.</p>
</div>
</div>
<div class="section" id="graphenoperationen">
<h3>3.1.2 Graphenoperationen<a class="headerlink" href="#graphenoperationen" title="Permalink to this headline">¶</a></h3>
<p>Angenommen jeder <a class="reference internal" href="../appendix.html#term-song"><em class="xref std std-term">Song</em></a> ist ein <em>Mapping</em> von Attributen zu Werten, so
können wir für jedes Attribut eine <a class="reference internal" href="../appendix.html#term-distanzfunktion"><em class="xref std std-term">Distanzfunktion</em></a> definieren. Nach
einer bestimmten Gewichtung können wir dann die einzelnen Distanzen
zusammenrechnen und zu einer gemeinsamen <a class="reference internal" href="../appendix.html#term-distanz"><em class="xref std std-term">Distanz</em></a> zusammenschmelzen.</p>
<p>Um mit unseren Graphen arbeiten zu können müssen wir einige Operationen auf ihm
definieren:</p>
<div class="section" id="rebuild">
<h4>3.1.2.1 <tt class="docutils literal"><span class="pre">rebuild</span></tt><a class="headerlink" href="#rebuild" title="Permalink to this headline">¶</a></h4>
<p>Bevor der Graph benutzt werden kann, muss er natürlich erstmal aufgebaut werden.
Der naive Ansatz wäre dabei für jeden Song die Distanzen zu jedem anderen Song
zu berechnen - dies hätte einen Aufwand von <span class="math">\(O(n^2)\)</span> zur Folge. Dies ist
aus oben genannten Gründen ebenfalls kaum wünschenswert.</p>
<p>Deshalb kann die <tt class="docutils literal"><span class="pre">rebuild</span></tt> Operation keinen <em>perfekten</em> Graph erzeugen, sondern
muss für hinreichend große Datenmengen auf eine Approximation zurückgreifen.</p>
<p>Nach dem Aufbau sollte ein ungerichteter Graph dabei herauskommen, im dem
idealerweise jeder Knoten vom jedem anderen Knoten erreichbar ist - es sollten
also keine <em>Inseln</em> dabei entstehen. Es gibt keine maximale Anzahl von Nachbarn,
die ein Song haben darf - lediglich einen <em>Richtwert</em>.</p>
</div>
<div class="section" id="rebuild-stupid">
<h4>3.1.2.2 <tt class="docutils literal"><span class="pre">rebuild_stupid</span></tt><a class="headerlink" href="#rebuild-stupid" title="Permalink to this headline">¶</a></h4>
<p>Wie <tt class="docutils literal"><span class="pre">rebuild</span></tt>, nutzt aber quadratischen Aufwand indem es jeden Song mit jedem
anderen vergleicht. Dies ist für kleine Mengen (<span class="math">\(\le 400\)</span>) von Songs
verträglich und für <em>sehr</em> kleine Mengen sogar schneller - tatsächlich fällt die
normale <tt class="docutils literal"><span class="pre">rebuild</span></tt>-Operation tatsächlich auf diese zurück, falls die Menge an
Songs <span class="math">\(\le 200\)</span>.</p>
<p>Hauptsächlich für Debuggingzwecke, um Fehler beim herkömmlichen <tt class="docutils literal"><span class="pre">rebuild</span></tt>
aufzudecken.</p>
</div>
<div class="section" id="add">
<h4>3.1.2.3 <tt class="docutils literal"><span class="pre">add</span></tt><a class="headerlink" href="#add" title="Permalink to this headline">¶</a></h4>
<p>Füge einen einzelnen Song zu dem Graphen hinzu, verbinde ihn aber noch nicht.
Dies ist die bevorzugte Operation um viele Songs dem Graphen hinzuzufügen -
beispielsweise beim <em>Kaltstart</em> - da das Verbinden später in einem
<tt class="docutils literal"><span class="pre">rebuild</span></tt>-Schritt erledigt werden kann.</p>
</div>
<div class="section" id="insert">
<h4>3.1.2.4 <tt class="docutils literal"><span class="pre">insert</span></tt><a class="headerlink" href="#insert" title="Permalink to this headline">¶</a></h4>
<p>Füge einen einzelnen Song zu dem Graphen hinzu und verbinde ihn. Suche dazu
erst eine passende Stelle in der er eingepasst wird.</p>
</div>
<div class="section" id="remove">
<h4>3.1.2.5 <tt class="docutils literal"><span class="pre">remove</span></tt><a class="headerlink" href="#remove" title="Permalink to this headline">¶</a></h4>
<p>Entferne einen einzelnen Song aus dem Graphen und versuche das entstandene
<em>Loch</em> zu flicken indem die Nachbarn des entfernten Songs untereinander
verkuppelt werden.</p>
</div>
<div class="section" id="modify">
<h4>3.1.2.6 <tt class="docutils literal"><span class="pre">modify</span></tt><a class="headerlink" href="#modify" title="Permalink to this headline">¶</a></h4>
<p>Manchmal ist es nötig das Attribut eines einzelnen Songs - wie beispielsweise
das stark vom Benutzer abhängige <strong>Rating</strong> - zu ändern. Dabei wird der Song
erst mittels <tt class="docutils literal"><span class="pre">remove</span></tt> entfernt, die Attribute werden angepasst und er wird
mittels <tt class="docutils literal"><span class="pre">insert</span></tt> wieder eingefügt.</p>
</div>
<div class="section" id="fixing">
<h4>3.1.2.7 <tt class="docutils literal"><span class="pre">fixing</span></tt><a class="headerlink" href="#fixing" title="Permalink to this headline">¶</a></h4>
<p>Durch das Löschen und Hinzufügen von Songs können <em>Einbahnstraßen</em> im Graphen
entstehen. Durch dem nach gelagerten <em>fixing</em> Schritt werden diese, nach
bestimmten Regeln, entweder entfernt oder in bidirektionale Verbindungen
umgebaut.</p>
</div>
</div>
<div class="section" id="ausstellen-von-empfehlungen">
<span id="recom-out"></span><h3>3.1.3 Ausstellen von Empfehlungen<a class="headerlink" href="#ausstellen-von-empfehlungen" title="Permalink to this headline">¶</a></h3>
<p>Das Ausstellen von Empfehlungen wird durch das Traversieren des Graphen
mittels einer Breitensuche erledigt. Dabei wird der Ursprung durch ein
sogenannten <a class="reference internal" href="../appendix.html#term-seedsong"><em class="xref std std-term">Seedsong</em></a> bestimmt. Anschaulich wäre der Seedsong bei einer
Anfrage wie ,,10 ähnliche Songs zu <em>The Beatles - Yellow Submarine</em> `` eben
<em>,,Yellow Submarine''</em>.</p>
<p>Aus der funktionalen Programmierung wurde dabei das Konzept der <em>Infinite
Iterators</em> übernommen: Anstatt eine bestimmte Anzahl von Empfehlungen als Liste
wird ein Versprechen herausgegeben die Empfehlungen genau dann zu berechnen wenn
sie gebraucht werden (<em>Lazy Evaluation</em>). Dadurch ist auch die Zahl der
zu gebenden Empfehlungen variabel - was sehr nützlich beim Erstellen einer
dynamischen Playlist ist.</p>
<p>Es können auch mehrere Seedsongs verwendet werden - dann werden die einzelnen
<em>Iteratoren</em> im Reißschlußverfahren verwebt.</p>
<p>Basierend auf dieser Idee ist es möglich bestimmte Strategien zu implementieren,
die beispielsweise Songs mit dem höchsten Playcount, dem besten Rating oder
einen bestimmten Attribut wie <em>genre=rock</em> als Seedsongs auswählt.</p>
</div>
<div class="section" id="filtern-von-empfehlungen">
<span id="recom-filter"></span><h3>3.1.4 Filtern von Empfehlungen<a class="headerlink" href="#filtern-von-empfehlungen" title="Permalink to this headline">¶</a></h3>
<p>Oft ist es nötig die gegebenen Empfehlungen noch zusätzlich zu filtern. Das hat
den simplen Grund das im Graphen die meisten Alben einzelne <em>Cluster</em> bilden -
die Lieder auf einem Album sind unter sich sehr ähnlich. Da man aber vermeiden
möchte, dass zu einem <a class="reference internal" href="../appendix.html#term-seedsong"><em class="xref std std-term">Seedsong</em></a> ein Lied vom selben Album oder gar selben
Künstler empfohlen wird, müssen diese beim Iterieren über den Graphen ausgesiebt
werden.</p>
<p>Dazu werden die zuletzt gegebenen Empfehlungen betrachtet - ist in
den letzten 5 Empfehlungen der gleiche Artist bereits vorhanden so wird die
Empfehlung ausgesiebt.</p>
</div>
<div class="section" id="lernen-durch-die-history">
<h3>3.1.5 Lernen durch die History<a class="headerlink" href="#lernen-durch-die-history" title="Permalink to this headline">¶</a></h3>
<p>Nur eine bestimmte Anzahl von Regeln wird gespeichert - zuviele Regeln würden
<em>historische Altlasten</em> immer weiter mitschleppen und der aktuelle Geschmack des
Benutzers würde nicht widergespiegelt werden.</p>
</div>
</div>
<div class="section" id="integration-von-libmunin-in-die-umwelt">
<h2>3.2 Integration von <em>libmunin</em> in die Umwelt<a class="headerlink" href="#integration-von-libmunin-in-die-umwelt" title="Permalink to this headline">¶</a></h2>
<div class="section" id="allgemeiner-ablauf">
<h3>3.2.1 Allgemeiner Ablauf<a class="headerlink" href="#allgemeiner-ablauf" title="Permalink to this headline">¶</a></h3>
<p>Eine gut definierte Datenstruktur nützt nichts wenn man nicht weiß wie die
Daten, die aus der <em>Umwelt</em> hereinkommen aussehen. Diese müssen schließlich
erstmal in die Form eines Graphen gebracht werden bevor man Empfehlungen
aussprechen kann. Dieser <em>Prozess</em> (siehe Abbildung <a href="#fig-startup">3.2</a>)
beinhaltet vier Schritte:</p>
<ul class="simple">
<li><strong>Kaltstart:</strong> Im Kaltstart müssen mittels <em>Information Retrieval</em> Techniken
fehlende Daten, wie beispielsweise die Songtexte oder die die Audiodaten, aus
lokalen oder entfernten Quellen besorgt werden. Dies ist Aufgabe des Nutzers -
<em>libmunin</em> bietet hier nur Hilfsfunktionen an.
Der <em>Kaltstart</em> ist nur bei der ersten Benutzung einer Musikdatenbank nötig.</li>
<li><strong>Analyse:</strong> Bei der <em>Analyse</em> werden die nun vorhandenen Daten untersucht und
durch sogenannte <a class="reference internal" href="../appendix.html#term-provider"><em class="xref std std-term">Provider</em></a> normalisiert. Die Normalisierung ist nötig
um im nächsten Schritt eine einfache und effiziente Vergleichbarkeit der Daten
zu gewährleisten.</li>
<li><strong>Rebuild:</strong> Dies entspricht der <tt class="docutils literal"><span class="pre">rebuild</span></tt>-Operation.
In diesem Schritt werden die normalisierten Daten untereinander mittels einer
passenden <a class="reference internal" href="../appendix.html#term-distanzfunktion"><em class="xref std std-term">Distanzfunktion</em></a> untersucht um mithilfe der dabei
entstehenden <a class="reference internal" href="../appendix.html#term-distanz"><em class="xref std std-term">Distanz</em></a> der Graph aufgebaut.</li>
<li><strong>Einsatz:</strong> Durch Traversierung des Graphen können jetzt Ergebnisse abgeleitet
werden.</li>
</ul>
<div class="figure align-center" id="fig-startup">
<a class="reference internal image-reference" href="../../_images/munin_startup.svg"><img alt="Allgemeine Benutzung" src="../../_images/munin_startup.svg" width="75%" /></a>
<p class="caption"><strong>Figure 3.2:</strong> Allgemeine Benutzung von libmunin</p>
</div>
</div>
<div class="section" id="die-umgebung">
<span id="environement"></span><h3>3.2.2 Die Umgebung<a class="headerlink" href="#die-umgebung" title="Permalink to this headline">¶</a></h3>
<p>In <a href="#fig-integration">3.3</a> ist eine Übersicht gegeben in welcher Umgebung
<em>libmunin</em> eingesetzt wird. Eine Frage die sich dabei stellt ist: <em>Wie</em> stellen
die Nutzer der Bibliothek ihre Musikdatenbank bereit? Und <em>wie</em> geben sie diese
in das System ein?</p>
<p>Dazu bedarf es einer weiteren Eingabe vom Nutzer: Einer Beschreibung wie seine
Musikdatenbank aufgebaut ist, welche <em>Tags</em> sie enthält und wie mit diesen Daten
verfahren werden soll.</p>
<p>Da diese Daten also sehr unterschiedlich aufgebaut sind, muss <em>libmunin</em> sehr
generisch aufgebaut sein. Der Ansatz ist dabei, zusätzlich vom Nutzer eine
<a class="reference internal" href="../appendix.html#term-maske"><em class="xref std std-term">Maske</em></a> zu verlangen die beschreibt welche möglichen <em>Tags</em> (oder
<a class="reference internal" href="../appendix.html#term-attribut"><em class="xref std std-term">Attribut</em></a>) ein einzelner Song besitzt Für jedes <a class="reference internal" href="../appendix.html#term-attribut"><em class="xref std std-term">Attribut</em></a> kann
dann, nach Baukastenprinzip, ein <a class="reference internal" href="../appendix.html#term-provider"><em class="xref std std-term">Provider</em></a>, eine <a class="reference internal" href="../appendix.html#term-distanzfunktion"><em class="xref std std-term">Distanzfunktion</em></a>
und eine Gewichtung ausgewählt werden. Letzere beschreibt wie <em>wichtig</em> diese
Attribut aus Sicht des Nutzers in Bezug auf die Ähnlichkeit ist. Der
<a class="reference internal" href="../appendix.html#term-provider"><em class="xref std std-term">Provider</em></a> normalisiert die Werte von einem <a class="reference internal" href="../appendix.html#term-attribut"><em class="xref std std-term">Attribut</em></a> auf bestimmte
Art und Weise, während die <a class="reference internal" href="../appendix.html#term-distanzfunktion"><em class="xref std std-term">Distanzfunktion</em></a> sich um das Vergleichen der
normalisierten Werte nach bestimmten, je auf Art des Attributs spezialisierten
Weise, kümmert.</p>
<p>Nachdem das Format, in Form der <a class="reference internal" href="../appendix.html#term-maske"><em class="xref std std-term">Maske</em></a>, geklärt ist, kann der Nutzer
jeden Song mittels der <tt class="docutils literal"><span class="pre">add</span></tt>-Operation hinzufügen und im Anschluss eine
<tt class="docutils literal"><span class="pre">rebuild</span></tt>-Operation triggern.</p>
<div class="figure align-center" id="fig-integration">
<a class="reference internal image-reference" href="../../_images/integration.svg"><img alt="Integrationsübersicht" src="../../_images/integration.svg" width="100%" /></a>
<p class="caption"><strong>Figure 3.3:</strong> Wie fügt sich libmunin in seine Umgebung ein?</p>
</div>
<p>Wir wissen nun wie unsere interne Datenstruktur auszusehen hat. Wir wissen auch
wie die Daten aussehen die von der Umwelt hereinkommen. Der nächste Schritt
darin, sich Gedanken über den <em>Layer</em> zu machen welcher zwischen beiden
vermittelt.</p>
<p>Tatsächlich besteht ein großer Teil von <em>libmunin</em> aus diesem <em>Layer</em> der Daten
aus der Umwelt nimmt und in die interne Graphendarstellung transferiert.</p>
<p>In Abbildung <a href="#fig-arch">3.4</a> findet sich eine Darstellung von <em>libmunin</em> als
,,Whitebox'' - sprich, als Box mit allen Ein- und Ausgängen, sowie der groben
Verarbeitung dazwischen. Dies ist als Zusammenfassung des oben gesagten zu
werten.</p>
<div class="figure align-center" id="fig-arch">
<a class="reference internal image-reference" href="../../_images/arch.svg"><img alt="Architekturübersicht." src="../../_images/arch.svg" width="100%" /></a>
<p class="caption"><strong>Figure 3.4:</strong> Betrachtung von libmunin als ,,Whitebox'' - Alle Ein- und Ausgaben in einem
Bild. In der Box selbst ist die grobe Verarbeitung der Daten skizziert.</p>
</div>
</div>
</div>
<div class="section" id="entwurf-der-software">
<h2>3.3 Entwurf der Software<a class="headerlink" href="#entwurf-der-software" title="Permalink to this headline">¶</a></h2>
<p>Da wir jetzt grob wissen aus welchen Komponenten unsere Software besteht können
wir uns Gedanken darüber machen wie diese einzelnen Teile konkret aussehen.  Im
folgenden werden die <em>,,Hauptakteure''</em> der Software vorgestellt:</p>
<div class="section" id="ubersicht">
<h3>3.3.1 Übersicht<a class="headerlink" href="#ubersicht" title="Permalink to this headline">¶</a></h3>
<p>Unter <a href="#fig-class-overview">3.5</a> findet sich eine grobe Übersicht der wichtigsten
Klassen.</p>
<div class="figure align-center" id="fig-class-overview">
<a class="reference internal image-reference" href="../../_images/class.svg"><img alt="Klassenübersicht" src="../../_images/class.svg" width="100%" /></a>
<p class="caption"><strong>Figure 3.5:</strong> Jeder Node ist eine Klasse in den jeweiligen Teilbereichen der Software.
Provider und DistanceFunction Unterklassen nur beispielhaft gezeigt.</p>
</div>
</div>
<div class="section" id="grobe-unterteilung">
<h3>3.3.2 Grobe Unterteilung<a class="headerlink" href="#grobe-unterteilung" title="Permalink to this headline">¶</a></h3>
<p>Wir schauen uns zuerst die einzelnen <em>Regionen</em> der Software an, danach
widmen wir uns den einzelnen Komponenten.</p>
<p>Grob ist die Software in fünf unterschiedliche <em>Regionen</em> aufgeteilt.</p>
<div class="section" id="api">
<h4>3.3.2.1 1. API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h4>
<p>Die API ist die Schnittstelle zum Benutzer hin. Der Nutzer kann mittels einer
<tt class="docutils literal"><span class="pre">Session</span></tt> auf alle Funktionen von <em>libmunin</em> zugreifen. Dazu muss er beim
Instanzieren derselben eine <tt class="docutils literal"><span class="pre">Maske</span></tt> angeben die die Musikdatenbank beschreibt.
Alternativ kann die <tt class="docutils literal"><span class="pre">EasySession</span></tt> genutzt werden die eine vordefinierte
<tt class="docutils literal"><span class="pre">Maske</span></tt> bereitstellt, die für viele Anwendungsfälle ausreichend ist.</p>
</div>
<div class="section" id="provider-pool">
<h4>3.3.2.2 2. <tt class="docutils literal"><span class="pre">Provider</span></tt> Pool<a class="headerlink" href="#provider-pool" title="Permalink to this headline">¶</a></h4>
<p>Implementiert eine große Menge vordefinierter Menge von Providern, die die
gängigsten Eingabedaten (wie Artist, Album, Lyrics, Genre, ...) abdecken.
Manche <tt class="docutils literal"><span class="pre">Provider</span></tt> dienen auch zum <em>Information Retrieval</em> und ziehen
beispielsweise Songtexte aus dem Internet.</p>
<p>Eine volle Liste von verfügbaren Providern wird unter <a class="reference internal" href="../IV/index.html#provider-list">4.4.1</a>
gegeben.</p>
<p>In der Übersicht <a href="#fig-class-overview">3.5</a> wurde aus Übersichtlichkeitsgründen
exemplarisch nur drei <a class="reference internal" href="../appendix.html#term-provider"><em class="xref std std-term">Provider</em></a> gezeigt</p>
</div>
<div class="section" id="distancefunction-pool">
<h4>3.3.2.3 3. <tt class="docutils literal"><span class="pre">DistanceFunction</span></tt> Pool<a class="headerlink" href="#distancefunction-pool" title="Permalink to this headline">¶</a></h4>
<p>Implementiert eine Menge vordefinierter Distanzfunktionen, welche die Werte der
obigen <tt class="docutils literal"><span class="pre">Provider</span></tt> vergleichen. Dabei kommen zwar viele Provider und
Distanzfunktion als Paare daher (wie beispielsweise der <tt class="docutils literal"><span class="pre">GenreTree</span></tt> Provider
und die <tt class="docutils literal"><span class="pre">GenreTree</span></tt> Distanzfunktion), was aber keine Notwendigkeit darstellt -
verschiedene Provider können beispielsweise dieselbe Distanzfunktion nutzen.</p>
<p>Eine volle Liste von verfügbaren Distanzfuktionen wird unter
<a class="reference internal" href="../IV/index.html#distance-function-list">4.4.2</a> gegeben.</p>
<p>In der Übersicht <a href="#fig-class-overview">3.5</a> wurde aus Übersichtlichkeitsgründen
exemplarisch nur drei <a class="reference internal" href="../appendix.html#term-provider"><em class="xref std std-term">Provider</em></a> gezeigt</p>
<p>Bibliotheksnutzer können eigene <tt class="docutils literal"><span class="pre">Provider</span></tt> oder <tt class="docutils literal"><span class="pre">DistanceFunctions</span></tt>
implementieren indem sie von den jeweiligen Oberklassen ableiten.</p>
</div>
<div class="section" id="songverwaltung">
<h4>3.3.2.4 4. Songverwaltung<a class="headerlink" href="#songverwaltung" title="Permalink to this headline">¶</a></h4>
<p>Hier geschieht alles was mit dem Speichern und Vergleichen einzelner Songs zu
tun hat. Dies umfasst das Speichern der <tt class="docutils literal"><span class="pre">Songs</span></tt> in der <tt class="docutils literal"><span class="pre">Database</span></tt> sowie das
Verwalten der Nachbarschafts-<tt class="docutils literal"><span class="pre">Songs</span></tt> für jeden <tt class="docutils literal"><span class="pre">Song</span></tt> mit den dazugehörigen
<tt class="docutils literal"><span class="pre">Distance</span></tt>.</p>
<p>Der oben erwähnte Graph entsteht durch die Verknüpfungen der Songs untereinander
und bildet keine eigenständige Klasse.</p>
</div>
<div class="section" id="regeln-und-history">
<h4>3.3.2.5 5. Regeln und History<a class="headerlink" href="#regeln-und-history" title="Permalink to this headline">¶</a></h4>
<p>Dieser Teil von <em>libmunin</em> ist für das Aufzeichnen des Benutzerverhaltens und dem
Ableiten von Assoziationsregeln daraus zuständig.</p>
</div>
</div>
<div class="section" id="einzelne-komponenten">
<h3>3.3.3 Einzelne Komponenten<a class="headerlink" href="#einzelne-komponenten" title="Permalink to this headline">¶</a></h3>
<p>Da UML-Diagramme sich oft in unwichtige Details und akribische
Methodenauflistungen versteigen, wird im folgenden textuell eine Auflistung
aller Klassen und ihrer Aufgabe gegeben. Nur in Einzelfällen werden
Methodennamen gekennzeichnet.</p>
<div class="section" id="session">
<h4>3.3.3.1 Session<a class="headerlink" href="#session" title="Permalink to this headline">¶</a></h4>
<p>Die Session ist das zentrale Objekt für den Nutzer der Bibliothek.
Es bietet über Proxymethoden Zugriff auf alle Funktionalitäten von <em>libmunin</em>
und kann zudem persistent abgespeichert werden. Dies wird durch das Python-Modul
<tt class="docutils literal"><span class="pre">pickle</span></tt> realisiert - es speichert rekursiv alle Member einer
<tt class="docutils literal"><span class="pre">Session</span></tt>-Instanz in einem Python-spezifischen Binärformat - Voraussetzung
hierfür ist, dass alle Objekte direkt oder indirekt an die <tt class="docutils literal"><span class="pre">Session</span></tt>-Instanz
gebunden sind.</p>
<p>Der Speicherort entspricht dem XDG-Standard, jede Session wird mit <tt class="docutils literal"><span class="pre">gzip</span></tt>
gepackt unter <tt class="docutils literal"><span class="pre">$HOME/.cache/libmunin/&lt;name&gt;.gz</span></tt> gespeichert.
Der <tt class="docutils literal"><span class="pre">&lt;name&gt;</span></tt> lässt sich der Session beim Instanzieren übergeben.</p>
<p>Die weitere Hauptzuständigkeit einer <tt class="docutils literal"><span class="pre">Session</span></tt> ist die Implementierung der
Recommendation-Strategien, die den Graphen traversieren.</p>
</div>
<div class="section" id="mask">
<h4>3.3.3.2 Mask<a class="headerlink" href="#mask" title="Permalink to this headline">¶</a></h4>
<p>Ein Hashtable-ähnliches Objekt, dass die Namen der einzelnen <a class="reference internal" href="../appendix.html#term-attribut"><em class="xref std std-term">Attribut</em></a>
festlegt. Da dies bereits in <a class="reference internal" href="#environement">3.2.2</a> erklärt wurde, wird hier
nochmal ein kurzes praktisches Beispiel gezeigt:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">m</span> <span class="o">=</span> <span class="n">Mask</span><span class="p">({</span>                              <span class="c"># Mask erwartet als Übergabe ein Dictionary</span>
     <span class="s">&#39;genre&#39;</span><span class="p">:</span> <span class="n">pairup</span><span class="p">(</span>                   <span class="c"># Verknüpfe Distanzfunktion mit Provider</span>
         <span class="n">GenreTreeProvider</span><span class="p">(),</span>           <span class="c"># Instanziere einen Provider</span>
         <span class="n">GenreTreeAvgLinkDistance</span><span class="p">(),</span>    <span class="c"># Instanziere eine Distanzfunktion</span>
         <span class="mi">4</span>                              <span class="c"># Gewichtung</span>
     <span class="p">),</span>  <span class="c"># ...</span>
<span class="p">})</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>                    <span class="c"># Instanziere eine Session mit dieser Maske</span>
</pre></div>
</div>
<p>Wie man sieht wird als ,,Key'' der Name des Attributes festgelegt, und als
,,Value'' ein Tupel aus einer <tt class="docutils literal"><span class="pre">Provider</span></tt>-Instanz, aus einer
<tt class="docutils literal"><span class="pre">DistanceFunction</span></tt>-Instanz und der Gewichtung dieses Attributes als <tt class="docutils literal"><span class="pre">float</span></tt>.</p>
<p>Wird statt einer <tt class="docutils literal"><span class="pre">Provider</span></tt> oder ein <tt class="docutils literal"><span class="pre">DistanceFunction</span></tt> Instanz etwas
anderes übergeben, so wird ein <tt class="docutils literal"><span class="pre">DefaultProvider</span></tt> (reicht die Werte unverändert
weiter), bzw. eine <tt class="docutils literal"><span class="pre">DefaultDistanceFunction</span></tt> (vergleicht Werte mit <tt class="docutils literal"><span class="pre">==</span></tt>).</p>
<p>Der Nutzer hat meist selber wenig mit der <tt class="docutils literal"><span class="pre">Mask</span></tt>-Instanz zu tun. Er übergibt
der <tt class="docutils literal"><span class="pre">Session</span></tt> eine Hashtable die implizit eine <tt class="docutils literal"><span class="pre">Mask</span></tt>-Instanz erzeugt.</p>
</div>
<div class="section" id="easysession">
<h4>3.3.3.3 EasySession<a class="headerlink" href="#easysession" title="Permalink to this headline">¶</a></h4>
<p>Wie die normale <tt class="docutils literal"><span class="pre">Session</span></tt>, bietet aber eine bereits fertigkonfigurierte
<a class="reference internal" href="../appendix.html#term-maske"><em class="xref std std-term">Maske</em></a> an, die für viele Anwendungsfälle ausreicht. In Tabelle
<a href="#fig-easy-session">3.6</a> ist eine Auflistung gegeben wie diese im Detail
konfiguriert ist.</p>
<div class="figure align-center" id="fig-easy-session">
<center><table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="18%" />
<col width="18%" />
<col width="27%" />
<col width="7%" />
<col width="17%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribut</th>
<th class="head align-left">Provider</th>
<th class="head align-left">Distanzfunktion</th>
<th class="head">Eingabe</th>
<th class="head align-left">Weight</th>
<th class="head">Kompression?</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">artist</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">ArtistNormalize</span></tt></td>
<td class="align-left">Default</td>
<td>Artistname</td>
<td class="align-left">1</td>
<td><span class="math">\(\CheckedBox\)</span></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">album</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">AlbumNormalize</span></tt></td>
<td class="align-left">Default</td>
<td>Albumtitel</td>
<td class="align-left">1</td>
<td><span class="math">\(\CheckedBox\)</span></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">title</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">TitleNormalize</span></tt></td>
<td class="align-left">Default</td>
<td>Tracktitel</td>
<td class="align-left">2</td>
<td><span class="math">\(\Box\)</span></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">date</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">Date</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">Date</span></tt></td>
<td>Datums-String</td>
<td class="align-left">4</td>
<td><span class="math">\(\Box\)</span></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">bpm</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">BPMCached</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">BPM</span></tt></td>
<td>Audiofile-Pfad</td>
<td class="align-left">6</td>
<td><span class="math">\(\Box\)</span></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">lyrics</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">Keywords</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">Keywords</span></tt></td>
<td>Songtext</td>
<td class="align-left">6</td>
<td><span class="math">\(\Box\)</span></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">rating</span></tt></td>
<td class="align-left">Default</td>
<td class="align-left"><tt class="docutils literal"><span class="pre">Rating</span></tt></td>
<td>Integer (<span class="math">\(0 \le x \le 5\)</span>)</td>
<td class="align-left">4</td>
<td><span class="math">\(\Box\)</span></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">genre</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">GenreTree</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">GenreTreeAvgLink</span></tt></td>
<td>Genre-String</td>
<td class="align-left">8</td>
<td><span class="math">\(\Box\)</span></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">moodbar</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">MoodbarAudioFile</span></tt></td>
<td class="align-left"><tt class="docutils literal"><span class="pre">Moodbar</span></tt></td>
<td>Audiofile-Pfad</td>
<td class="align-left">9</td>
<td><span class="math">\(\Box\)</span></td>
</tr>
</tbody>
</table>
<p class="caption"><strong>Figure 3.6:</strong> Default-Konfiguration der ,,EasySession''.</p>
</center></div></div>
<div class="section" id="song">
<h4>3.3.3.4 Song<a class="headerlink" href="#song" title="Permalink to this headline">¶</a></h4>
<p>Speichert fur jedes <a class="reference internal" href="../appendix.html#term-attribut"><em class="xref std std-term">Attribut</em></a> einen Wert, oder einen leeren Wert falls
das <a class="reference internal" href="../appendix.html#term-attribut"><em class="xref std std-term">Attribut</em></a> nicht gesetzt wurde. Dies ähnelt einer Hashtable,
allerdings werden nur die Werte gespeichert, die ,,Keys'' der Hashtable werden
in der <tt class="docutils literal"><span class="pre">Maske</span></tt> gespeichert und werden nur referenziert. Der Grund dieser
Optimierung liegt in verminderten Speicherverbrauch.</p>
<p>Eine weitere Kompetenz dieser Klasse ist das Verwalten der Distanzen zu seinen
Nachbarsongs. Er muss Methoden bieten um eine <a class="reference internal" href="../appendix.html#term-distanz"><em class="xref std std-term">Distanz</em></a> zu einem Nachbarn
hinzuzufügen oder zu entfernen, Methoden um über alle Nachbarn zu iterieren oder
die <a class="reference internal" href="../appendix.html#term-distanz"><em class="xref std std-term">Distanz</em></a> zu einen bestimmten Nachbarn abzufragen
und eine <tt class="docutils literal"><span class="pre">disconnect()</span></tt> Methode um den <tt class="docutils literal"><span class="pre">Song</span></tt> zu entfernt ohne dabei ein
,,Loch'' zu hinterlassen.</p>
<p>Tatsächlich gibt es kein eigene <tt class="docutils literal"><span class="pre">Graph</span></tt>-Klasse - der <a class="reference internal" href="../appendix.html#term-graph"><em class="xref std std-term">Graph</em></a> an sich
wird durch die Verknüpfung der einzelnen Songs in der <tt class="docutils literal"><span class="pre">Database</span></tt> gebildet -
jede <tt class="docutils literal"><span class="pre">Song</span></tt> Instanz bildet dabei einen Knoten.</p>
<p>Da eine Veränderung von Attributen im Song auch eine Veränderung im Graphen zur
Folge haben kann sind Instanzen der <tt class="docutils literal"><span class="pre">Song</span></tt> Klasse <em>Immutable</em>, sprich nach
ihrer Erstellung kann ihr Inhalt nicht mehr verändern werden. Ist dies trotzdem
vonnöten kann die <tt class="docutils literal"><span class="pre">modify</span></tt>-Operation eingesetzt werden.</p>
</div>
<div class="section" id="distance">
<h4>3.3.3.5 Distance<a class="headerlink" href="#distance" title="Permalink to this headline">¶</a></h4>
<p>Wie die <tt class="docutils literal"><span class="pre">Song</span></tt> Klasse, speichert aber statt den Werten von bestimmten
Attributen die <a class="reference internal" href="../appendix.html#term-distanz"><em class="xref std std-term">Distanz</em></a> zwischen zwei Attributen. Zusätzlich wird die
gewichtete Gesamtdistanz gespeichert. Diese Klasse ist ebenfalls <em>Immutable</em>.</p>
<p>Anschaulich ist das in <a href="#fig-distance-table">3.7</a> dargestellt.</p>
<div class="figure align-center" id="fig-distance-table">
<center><table border="1" class="docutils">
<colgroup>
<col width="65%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head align-center"><em>Attribut</em></th>
<th class="head align-center"><em>Distanz</em></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td class="align-center"><tt class="docutils literal"><span class="pre">lyrics</span></tt></td>
<td class="align-center">0.9</td>
</tr>
<tr class="row-odd"><td class="align-center"><tt class="docutils literal"><span class="pre">genre</span></tt></td>
<td class="align-center">0.05</td>
</tr>
<tr class="row-even"><td class="align-center">...</td>
<td class="align-center">...</td>
</tr>
<tr class="row-odd"><td class="align-center">Gewichtete Distanz</td>
<td class="align-center">0.1</td>
</tr>
</tbody>
</table>
<p class="caption"><strong>Figure 3.7:</strong> Anschauliche Darstellung der Daten die in einer ``Distance``
Instanz gespeichert werden</p>
</center></div><p>Unterdistanzen die nicht berechnet wurden konnten, weil beispielsweise ein oder
beide Attribut in den Quellsongs nicht gesetzt war, werden auch nicht
gespeichert. Sie fließen aber dennoch in die gewichtete Gesamtdistanz mit ein.</p>
<p>Man hätte auch einen einzelnen <tt class="docutils literal"><span class="pre">float</span></tt> als <tt class="docutils literal"><span class="pre">Distanz</span></tt> nehmen könne, da aber
die einzelnen Unterdistanzen für jedes :term:<tt class="docutils literal"><span class="pre">Attribut</span></tt> bekannt sind kann
später eine Empfehlung ,,erklärt'' werden - beispielsweise kann man dadurch
feststellen dass das <tt class="docutils literal"><span class="pre">lyrics</span></tt>-Attribut fast komplett unähnlich war, da das
<tt class="docutils literal"><span class="pre">genre</span></tt>-Attribut aber eine Distanz von <span class="math">\(0.05\)</span> hat wurde dieser Song
vorgeschlagen.</p>
<p>Zudem kann diese Information in späteren Implementierungen dazu eingesetzt
werden, während der Laufzeit bestimmte Attribute stärker oder schwächer zu
gewichten.</p>
</div>
<div class="section" id="database">
<h4>3.3.3.6 Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h4>
<p>Die <tt class="docutils literal"><span class="pre">Database</span></tt> Klasse ist eine logische Abtrennung der <tt class="docutils literal"><span class="pre">Session</span></tt> um eine
einzige, allmächtige ,,Superklasse'' zu verhindern.</p>
<p>Sie hat folgende Aufgaben:</p>
<ul class="simple">
<li>Implementierung der einzelnen, oben besprochenen Graphenoperationen.</li>
<li>Zu diesen Zweck hält sie eine Liste von <tt class="docutils literal"><span class="pre">Songs</span></tt>.</li>
<li>ID-Vergabe für jeden <tt class="docutils literal"><span class="pre">Song</span></tt>.</li>
<li>Verwaltung der <em>Playcounts</em>, also wie oft jeder <tt class="docutils literal"><span class="pre">Song</span></tt> gespielt wurde.</li>
<li>Verwaltung der <tt class="docutils literal"><span class="pre">ListenHistory</span></tt> (siehe <a class="reference internal" href="#listen-history">3.3.3.9</a>)</li>
<li>Finden von Songs mit bestimmten Attributen.</li>
</ul>
</div>
<div class="section" id="history">
<h4>3.3.3.7 History<a class="headerlink" href="#history" title="Permalink to this headline">¶</a></h4>
<p>Oberklasse für <tt class="docutils literal"><span class="pre">RecommendationHistory</span></tt> und <tt class="docutils literal"><span class="pre">ListenHistory</span></tt>. Implementiert
die gemeinsame Funktionalität Songs die zeitlich hintereinander zur <tt class="docutils literal"><span class="pre">History</span></tt>
hinzugefügt werden in <em>Gruppen</em> einzuteilen. Gruppen beinhalten maximal eine
bestimmte Anzahl von Songs, ist eine <em>Gruppe</em> voll so wird eine neue angefangen.
Vergeht aber eine zu lange Zeit seit dem letzten Hinzufügen wird ebenfalls
eine neue <em>Gruppe</em> begonnen. Jede abgeschlossene <em>Gruppe</em> wird in der
<tt class="docutils literal"><span class="pre">History</span></tt> abgespeichert.</p>
<p>Das Ziel der zeitlichen Gruppierung ist eine Abbildung des Nutzerverhaltens.
Die Annahme ist hierbei dass große zeitliche Lücken zwischen zwei Liedern auf
wenig zusammenhängende Songs hindeuten. Zudem bilden die einzelnen <em>Gruppen</em> eine
Art ,,Warenkorb'' der dann bei der Ableitung von Regeln genutzt werden kann.</p>
</div>
<div class="section" id="recommendationhistory">
<h4>3.3.3.8 RecommendationHistory<a class="headerlink" href="#recommendationhistory" title="Permalink to this headline">¶</a></h4>
<p>Implementiert den unter <a class="reference internal" href="#recom-filter">3.1.4</a> erwähnten Mechanismus zum Filtern
von Empfehlungen.</p>
</div>
<div class="section" id="listenhistory">
<span id="listen-history"></span><h4>3.3.3.9 ListenHistory<a class="headerlink" href="#listenhistory" title="Permalink to this headline">¶</a></h4>
<p>Unterklasse von <tt class="docutils literal"><span class="pre">History</span></tt>.</p>
<p>Speichert die chronologische Reihenfolge von gehörten Songs.</p>
<p>Es ist die Aufgabe des Nutzers der Bibliothek einzelne Songs über die
<tt class="docutils literal"><span class="pre">Session</span></tt>-Instanz zur <tt class="docutils literal"><span class="pre">ListenHistory</span></tt> hinzuzufügen. Die Entscheidung ob
hinzugefügt wird, sollte auf Basis der tatsächlich gehörten Länge des Stücks
entschieden werden. Songs die der Endnutzer einfach ,,skippt'' und die er zu
nahe <span class="math">\(0\%\)</span> angehört hat sollten auch nicht als Lerneingabe genutzt werden.</p>
</div>
<div class="section" id="rulegenerator">
<h4>3.3.3.10 RuleGenerator<a class="headerlink" href="#rulegenerator" title="Permalink to this headline">¶</a></h4>
<p>Analysiert die Gruppen innerhalb einer <tt class="docutils literal"><span class="pre">History</span></tt> und leitet daraus mittels
einer Warenkorbanalyse Assoziationsregeln ab. Diese werden danach im
<tt class="docutils literal"><span class="pre">RuleIndex</span></tt> gespeichert.</p>
</div>
<div class="section" id="ruleindex">
<h4>3.3.3.11 RuleIndex<a class="headerlink" href="#ruleindex" title="Permalink to this headline">¶</a></h4>
<p>Speichert und indiziert die vom <tt class="docutils literal"><span class="pre">RuleGenerator</span></tt> erzeugten Assoziationsregeln.
Da es später möglich sein muss jede <a class="reference internal" href="../appendix.html#term-assoziationsregel"><em class="xref std std-term">Assoziationsregel</em></a> abzufragen die
einen bestimmten Song betrifft ist es vonnöten eine zusätzliche Hashtable von
Songs auf Assoziationsregeln zu halten die als Index dient.</p>
<p>Zudem <em>,,vergisst''</em> der Index Regeln die Songs betreffen die nicht mehr in der
<tt class="docutils literal"><span class="pre">ListenHistory</span></tt> vorhanden sind.</p>
</div>
<div class="section" id="provider">
<h4>3.3.3.12 Provider<a class="headerlink" href="#provider" title="Permalink to this headline">¶</a></h4>
<p>Die Oberklasse von der jeder konkreter <tt class="docutils literal"><span class="pre">Provider</span></tt> ableitet.</p>
<p>Jeder Provider bietet eine <tt class="docutils literal"><span class="pre">do_process()</span></tt> Methode die von den Unterklassen
überschrieben wird. Zudem bieten viele Provider als <em>,,Convinience''</em> eine
<tt class="docutils literal"><span class="pre">do_reverse()</span></tt> Methode um für Debuggingzwecke den Originalwert vor der
Verarbeitung durch den Provider anzuzeigen.</p>
<p>Provider können zudem mittels des ,,|'' Operators in einer Kette
zusammengeschaltet werden. Intern wird ein <tt class="docutils literal"><span class="pre">CompositeProvider</span></tt> erzeugt - siehe
dazu auch <a class="reference internal" href="../IV/index.html#composite-provider">4.4.1.6</a>.</p>
<p>Oft kommt es vor dass die Eingabe für einen <a class="reference internal" href="../appendix.html#term-provider"><em class="xref std std-term">Provider</em></a> viele Dupletten
enthält - beispielsweise wird derselbe Artist-Name für viele Songs eingepflegt.
Diese redundant zu speichern wäre bei großen Sammlungen unpraktisch daher bietet
jeder Provider die Möglichkeit einer primitiven Kompression: Statt den Wert
abzuspeichern wird eine bidirektionale Hashtable mit den Werten als Schlüssel
und einer Integer-ID auf der Gegenseite. Dadurch wird jeder Wert nur einmal
gespeichert und statt dem eigentlichen Wert wird eine ID herausgegeben.</p>
</div>
<div class="section" id="distancefuntion">
<h4>3.3.3.13 DistanceFuntion<a class="headerlink" href="#distancefuntion" title="Permalink to this headline">¶</a></h4>
<p>Die Oberklasse von der jede konkrete <tt class="docutils literal"><span class="pre">DistanceFunction</span></tt> ableitet.</p>
<p>Jede Distanzfunktion bietet eine <tt class="docutils literal"><span class="pre">do_compute()</span></tt> Methode die von den
Unterklassen überschrieben wird.</p>
<p>Um die bei den Providern mögliche <em>Kompression</em> wieder rückgängig zu machen muss
die Distanzfunktion den <a class="reference internal" href="../appendix.html#term-provider"><em class="xref std std-term">Provider</em></a> kennen.</p>
</div>
</div>
</div>
</div>


          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="../IV/index.html" class="btn btn-neutral float-right" title="4 Implementierung"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../II/index.html" class="btn btn-neutral" title="2 Einstieg"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <p>
      &copy; Copyright by Christopher Pahl, 2013-2014..
  </p>

  <a href="https://www.github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="http://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  

</body>
</html>